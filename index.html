<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SVG Cubic Curve Path</title>

<style>
body {
  font-family: sans-serif;
  display: flex;
  justify-content: center;
  color: #454545;
  font-weight: 300;
  margin-top: 4em;
}
svg {
position: flex;
/* margin-left: 50px;*/
/* margin-top: 30px;*/
/* margin-bottom: 2em;*/
  background-color: #ffffff;
}
#page-container {
  position:relative;
  width: 800px;
  /*border: 1px solid red;*/
  padding: 0;
  display: inline-block;
  margin-left: auto;
  margin-right: auto;
}

h1 {
  font-size: 24px;
  font-weight: 500;
  margin-bottom: 2em;
}
h2 {
  font-size: 20px;
  font-weight: 400;
  margin-top: 2em;
}
p {
  line-height: 1.4em;
}
img {
  width: 100%;
  margin-bottom: 2em;
}
figurecaption {
  font-size: 0.9em;
  font-weight: 600;
  margin-left: 2em;
}
ul {
  list-style-type: number;
}
li:not(:last-child) {
    margin-bottom: 0.5em;
}
.footer {
  /*position: fixed;*/
  left: 0;
  bottom: 0;
  min-height: 10em;
  width: 100%;
  /*background-color: red;*/
}

</style>

</head>

<body>

<div id="page-container">
<h1>SVG Cubic Curve Path</h1>
<p>Drag the blue node points on the interactive svg canvas below to see how the path definition for this cubic curve path changes.</p>
<svg version="1.1" width="800" height="400" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">

  <g id="grid" fill="none" stroke="black" stroke-width="0.05">
  <path id="vertical-grid" d="M0.1 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m9.8 0 v50"/>
  <path id="horizontal-grid" d="M0 0.1 h100 m0 10 h-100 m0 10 h100 m0 10 h-100 m0 10 h100 m0 9.8 h-100"/>
  </g>

  <g id="axis-labels" font-size="2" fill="black">
    <g id="x-Labels" text-anchor="left">
    <text x="0" y="2">0</text>
    <text x="10" y="2">10</text>
    <text x="20" y="2">20</text>
    <text x="30" y="2">30</text>
    <text x="40" y="2">40</text>
    <text x="50" y="2">50</text>
    <text x="60" y="2">60</text>
    <text x="70" y="2">70</text>
    <text x="80" y="2">80</text>
    <text x="90" y="2">90</text>
    <text x="100" y="2">100</text>
    </g>
    <g id="y-labels" text-anchor="left">
    <text x="0" y="10">10</text>
    <text x="0" y="20">20</text>
    <text x="0" y="30">30</text>
    <text x="0" y="40">40</text>
    <text x="0" y="50">50</text>
    </g>
  </g>
  
  <g id="points" fill="blue" stroke="none" font-size="2">
  <!-- child order critical to function -->
  <path data-node="" d="M10 10 h10" stroke="red" stroke-width="0.2"/>
  <path d="M10 20 20 20" stroke="red" stroke-width="0.2"/>
  <path stroke="green" stroke-width="0.2" d="M10 10 C20 10 20 20 10 20" fill="none"/>
  <circle data-node="0" cx="10" cy="10" r="0.5"/>
  <text x="10" y="9" fill="red" text-anchor="middle">10,10</text>
  <circle data-node="1" cx="20" cy="10" r="0.5"/>
  <text x="20" y="9" fill="red" text-anchor="middle">20,10</text>
  <circle data-node="2" id="handle" cx="20" cy="20" r="0.5"/>
  <text x="20" y="19" fill="red" text-anchor="middle">20, 20</text>
  <circle data-node="3" cx="10" cy="20" r="0.5"/>
  <text x="10" y="19" fill="red" text-anchor="middle">10,20</text>
  <rect x="20" y="47" width="50" height="2.5" fill="white" />
  <text id="definition-report" text-anchor="left" x="20" y="49" fill="green">green path definition: d="M10 10 C20 10 20 20 10 20"</text>
  </g>
</svg>
<h2>Paths and Curves</h2>
<p>A path tag in svg results in a line being drawn. Path tags include attributes to set the line colour and width and a single definition attribute containing a list of instruction that define the line. The path definition is a linear stream of letter-character action values, each followed by numerical values that specify a point on the canvas.</p>

<figure>
<img src="cubic_curve_definition.png" alt="The anatomy of a cubic curve path definition"/>
<figurecaption><em>Figure:</em> Image showing a cubic path definition (d) and the points to which each value correspond</figurecaption>
</figure>

<h2>Notes</h2>
<ul>
  <li>Numerical values in path definitions are <i>user units</i>, not pixels etc.</li>
  <li>The example shown uses absolute coordinate references (upper-case commands)</li>
  <li>Relative coordinates would be specified with lower-case command letters</li>
  <li>The <b>M</b> command character defines the starting position for <i>any</i> following command</li>
  <li>In this definition, the next command character <b>C</b> specifies that a <b>C</b>ubic curve follows</li>
  <li>Cubic curve definitions include two gradient points (these are not usually visible)</li>
  <li>The first gradient point determines the curvature from the preceding point</li>
  <li>The second gradient point determines the curvature to the following point</li>
</ul>

<h2>Further Information</h2>
<p>Comprehensive information of SVG <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths" target="_blank">paths</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#curve_commands" target="_blank">cubic curve</a> definitions is available at the <a href="https://developer.mozilla.org/" target="_blank">Mozilla developer web site</a></p>

<div class="footer"></div>
</div>

<script>

window.onload = function() {
// all functionality wrapped here to fire onload;

let down=false;
const canvas = document.getElementsByTagName('svg')[0]; 
const circles = document.getElementById('points').getElementsByTagName('circle');
const paths = document.getElementById('points').getElementsByTagName('path');
const labels = document.getElementById('points').getElementsByTagName('text');
let nodeNumber = -1;
let lineNumber = -1;
Points = [{x:10, y:10}, {x:20, y:10}, {x:20, y:20}, {x:10, y:20}];

canvas.addEventListener('mousedown', event => {
  if (event.target.tagName == 'circle') {
  canvasLeftBorder = canvas.getBoundingClientRect().left; // global, needed in mousemove event;
  canvasRightBorder = canvas.getBoundingClientRect().top; // global;
  nodeNumber = parseInt(event.target.dataset.node);
  lineNumber = (nodeNumber < 2) ? 0 : 1;
  down=true; 
  } // end if circle targetted;
});

canvas.addEventListener('mousemove', event => {
   if (down) {
   X = (event.clientX-canvasLeftBorder)/8;
   Y = (event.clientY-canvasRightBorder)/8;

   Points[nodeNumber] = {x:X, y:Y};

   circles[nodeNumber].setAttribute('cx', `${X}`);
   circles[nodeNumber].setAttribute('cy', `${Y}`)   
   paths[lineNumber].setAttribute('d', lineDefinition(lineNumber) );
   paths[2].setAttribute('d', curveDefinition());
   labels[nodeNumber].outerHTML = `<text x="${X}" y="${Y-1}" text-anchor="middle" fill="red">${parseInt(X)}, ${parseInt(Y)}</text>`; 
   document.getElementById('definition-report').outerHTML = displayDefinition(); 
   }  
});

canvas.addEventListener('mouseup', event => {
down=false;
nodeNumber = -1;
lineNumber = -1; 
});

function lineDefinition (lineNumber) {
return `M${Points[lineNumber*2].x} ${Points[lineNumber*2].y} ${Points[lineNumber*2+1].x} ${Points[lineNumber*2+1].y}`;
}

function curveDefinition () {
   return`M${Points[0].x} ${Points[0].y} C${Points[1].x} ${Points[1].y} ${Points[2].x} ${Points[2].y} ${Points[3].x} ${Points[3].y}`;}

function integerCoordinates () {
   return`M${parseInt(Points[0].x)} ${parseInt(Points[0].y)} C${parseInt(Points[1].x)} ${parseInt(Points[1].y)} ${parseInt(Points[2].x)} ${parseInt(Points[2].y)} ${parseInt(Points[3].x)} ${parseInt(Points[3].y)}`;
}

function displayDefinition() {
return `<text id="definition-report" x="20" y="49" text-anchor="left" fill="green">green path definition: d="${integerCoordinates()}"</text>`;
}

} // end onload function;


</script>

</body>
</html>