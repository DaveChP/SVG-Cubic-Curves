<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SVG Curves</title>

<style>
body {
  font-family: sans-serif;
  padding: 0px;
  margin: 0;
}
svg {
  position: absolute;
  left: 50px;
  top: 30px;
  background-color: #ffffff;
}
#svg-frame {
  border: 0;
  padding: 0;
  margin: 0;
}

</style>

</head>

<body>

<div id="svg-frame">
<svg version="1.1" width="800" height="400" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">

  <g id="grid" fill="none" stroke="black" stroke-width="0.05">
  <path id="vertical-grid" d="M0.1 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m10 0 v50 m10 0 v-50 m9.8 0 v50"/>
  <path id="horizontal-grid"d="M0 0.1 h100 m0 10 h-100 m0 10 h100 m0 10 h-100 m0 10 h100 m0 9.8 h-100"/>
  </g>

  <g id="axis-labels" font-size="2" fill="black">
    <g id="x-Labels" text-anchor="left">
    <text x="0" y="2">0</text>
    <text x="10" y="2">10</text>
    <text x="20" y="2">20</text>
    <text x="30" y="2">30</text>
    <text x="40" y="2">40</text>
    <text x="50" y="2">50</text>
    <text x="60" y="2">60</text>
    <text x="70" y="2">70</text>
    <text x="80" y="2">80</text>
    <text x="90" y="2">90</text>
    <text x="100" y="2">100</text>
    </g>
    <g id="y-labels" text-anchor="left">
    <text x="0" y="10">10</text>
    <text x="0" y="20">20</text>
    <text x="0" y="30">30</text>
    <text x="0" y="40">40</text>
    <text x="0" y="50">50</text>
    </g>
  </g>
  
  <g id="points" fill="blue" stroke="none" font-size="2" text-anchor="middle">
  <path data-node="" d="M10 10 h10" stroke="red" stroke-width="0.2"/>
  <path d="M10 20 20 20" stroke="red" stroke-width="0.2"/>
  <path stroke="green" stroke-width="0.2" d="M10 10 C20 10 20 20 10 20" fill="none"/>
  <circle data-node="0" cx="10" cy="10" r="0.5"/>
  <text x="10" y="9" fill="red">10,10</text>
  <circle data-node="1" cx="20" cy="10" r="0.5"/>
  <text x="20" y="9" fill="red">20,10</text>
  <circle data-node="2" id="handle" cx="20" cy="20" r="0.5"/>
  <text x="20" y="19" fill="red">20, 20</text>
  <circle data-node="3" cx="10" cy="20" r="0.5"/>
  <text x="10" y="19" fill="red">10,20</text>
  </g>

<!--
<path  stroke="#000000" stroke-width="1" fill="none" d="M300 100 C400 120, 500 300, 200 200" />
-->

</svg>
</div>
<script>
let down=false;
const canvas = document.getElementById('svg-frame');
let nodeNumber = -1;
let lineNumber = -1; 

canvas.addEventListener('mousedown', event => {
  if (event.target.tagName == 'circle') {
  nodeNumber = (event.target.tagName == 'circle') ? parseInt(event.target.dataset.node) : -1;
  lineNumber = (nodeNumber < 2) ? 0 : 1;
  down=true; 
  } // end if circle targetted;
});

Points = [{x:10, y:10}, {x:20, y:10}, {x:20, y:20}, {x:10, y:20}];
canvas.addEventListener('mousemove', event => {
   if (down) {
   X = parseInt(event.clientX/8 - 6);
   Y = parseInt(event.clientY/8 -3.8);
   document.getElementById('points').getElementsByTagName('circle')[nodeNumber].setAttribute('cx', `${event.clientX/8 - 6}`);
   document.getElementById('points').getElementsByTagName('circle')[nodeNumber].setAttribute('cy', `${event.clientY/8 -3.8}`)
   Points[nodeNumber] = {x:event.clientX/8 - 6, y:event.clientY/8 -3.8};
   
   document.getElementById('points').getElementsByTagName('path')[lineNumber].setAttribute('d', modifyHandles(lineNumber) );

   modifyCurve();

   document.getElementById('points').getElementsByTagName('text')[nodeNumber].outerHTML = `<text x="${event.clientX/8 - 6}" y="${event.clientY/8 -5}" fill="red">${X}, ${Y}</text>`;  
   }  
});

canvas.addEventListener('mouseup', event => {
console.log(event.clientX);
down=false;
nodeNumber = -1;
lineNumber = -1; 
});

function modifyHandles (lineNumber) {
return `M${Points[lineNumber*2].x} ${Points[lineNumber*2].y} ${Points[lineNumber*2+1].x} ${Points[lineNumber*2+1].y}`;
} // end handles redraw;

function modifyCurve () {
   document.getElementById('points').getElementsByTagName('path')[2].setAttribute('d', `M${Points[0].x} ${Points[0].y} C${Points[1].x} ${Points[1].y} ${Points[2].x} ${Points[2].y} ${Points[3].x} ${Points[3].y}`);
}


</script>

</body>
</html>